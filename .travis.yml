sudo: false
dist: trusty

language: scala

scala:
  - 2.12.3

jdk:
  - oraclejdk8

# These directories are cached to S3 at the end of the build
cache:
  directories:
    - $HOME/.ivy2/cache
    - $HOME/.sbt/boot/

before_cache:
  # Cleanup the cached directories to avoid unnecessary cache updates
  - find $HOME/.ivy2/cache -name "ivydata-*.properties" -print -delete
  - find $HOME/.sbt        -name "*.lock"               -print -delete

script:
  - sbt -jvm-opts .travis.jvmopts -sbt-version 0.13.16 -scala-version $TRAVIS_SCALA_VERSION ";set parallelExecution in ThisBuild := false; coreJVM/testOnly *.c.* -- timefactor 3 neverstore exclude travis"
  - sbt -jvm-opts .travis.jvmopts -sbt-version 0.13.16 -scala-version $TRAVIS_SCALA_VERSION ";set parallelExecution in ThisBuild := false; coreJVM/testOnly *.e.* -- timefactor 3 neverstore exclude travis"
  - sbt -jvm-opts .travis.jvmopts -sbt-version 0.13.16 -scala-version $TRAVIS_SCALA_VERSION ";set parallelExecution in ThisBuild := false; coreJVM/testOnly *.i.* -- timefactor 3 neverstore exclude travis"
  - sbt -jvm-opts .travis.jvmopts -sbt-version 0.13.16 -scala-version $TRAVIS_SCALA_VERSION ";set parallelExecution in ThisBuild := false; coreJVM/testOnly *.m.* -- timefactor 3 neverstore exclude travis"
  - sbt -jvm-opts .travis.jvmopts -sbt-version 0.13.16 -scala-version $TRAVIS_SCALA_VERSION ";set parallelExecution in ThisBuild := false; coreJVM/testOnly *.s.* -- timefactor 3 neverstore exclude travis"
  - sbt -jvm-opts .travis.jvmopts -sbt-version 0.13.16 -scala-version $TRAVIS_SCALA_VERSION ";set parallelExecution in ThisBuild := false; coreJVM/testOnly *.r.* -- timefactor 3 neverstore exclude travis"
  - sbt -jvm-opts .travis.jvmopts -sbt-version 0.13.16 -scala-version $TRAVIS_SCALA_VERSION ";set parallelExecution in ThisBuild := false; coreJVM/testOnly *.t.* -- timefactor 3 neverstore exclude travis"
  - sbt -jvm-opts .travis.jvmopts -sbt-version 0.13.16 -scala-version $TRAVIS_SCALA_VERSION ";set parallelExecution in ThisBuild := false; coreJVM/testOnly *.x.* -- timefactor 3 neverstore exclude travis"

  #- ./.travis-test.sh coreJVM
  - ./.travis-test.sh tests

  - ./.travis-test.sh examplesJVM
  - ./.travis-test.sh junitJVM
  - ./.travis-test.sh matcherExtraJVM
  - ./.travis-test.sh mockJVM
  - ./.travis-test.sh scalacheckJVM
  - ./.travis-test.sh scalazJVM
  - ./.travis-test.sh shapelessJVM

  - ./.travis-test.sh gwt
  - ./.travis-test.sh html
  - ./.travis-test.sh markdown
  - ./.travis-test.sh tests

  - ./.travis-test.sh coreJS
  - ./.travis-test.sh examplesJS

  - find $HOME/.sbt -name "*.lock" | xargs rm
  - find $HOME/.ivy2 -name "ivydata-*.properties" | xargs rm

notifications:
  webhooks:
    urls:
      - https://webhooks.gitter.im/e/6f43e8d682579a80ef5f
    on_success: always
    on_failure: always
    on_start:   never
